<template name="usersEditView">
  {{> quickForm schema=schema doc=this.user id="updateUserForm"}}
</template>


<template name="usersEditView222">
  <div class="box box-default">
    <div class="box-body">
      <h4>User Roles</h4>
      <img class="home-spinner hide" alt="spinner" src="/imgs/spinner.gif" />
      {{#each userRoles}}
        <button class="btn btn-primary btn-xs {{#if this.selected }}btn-remove-role{{/if}}" role="{{this.role}}" user="{{admin_current_id}}">
          {{this.role}}
        </button>
      {{/each}}
      <p style="margin-top:5px;">Click a role to toggle it.</p>
    </div>
  </div>

  <div class="box box-default">
    <div class="box-body">
      <h4>HMIS Profile</h4>
      <div class="row">
        <div class="col-md-6 col-md-offset-1">
          <form id="edit-user" class="form-horizontal" role="form">
            {{#with user.services.HMIS}}
              {{> hmisProfile}}
            {{/with}}
            {{#if canUpdateProfile}}
              <div class="form-group">
                <label class="col-md-4 control-label"></label>
                <div class="col-md-8">
                  <input type="submit" class="btn btn-large btn-success" value="Save Profile" />
                </div>
              </div>
            {{/if}}
          </form>
        </div>
      </div>

    </div>
  </div>
  {{#if isLoggedUser}}
    <div class="box box-default">
      <div class="box-body">
        <h4>Change Password</h4>
        <div class="row">
          <div class="col-md-6 col-md-offset-1">
            <form form id="change-password" class="form-horizontal" role="form">
              {{> changePasswordForm}}
            </form>
          </div>
        </div>
      </div>
    </div>
  {{/if}}
  <div class="box box-default">
    <div class="box-body">
      <h4>Linked Projects</h4>
      <div class="row">
        <div class="col-md-6 col-md-offset-1">
          {{#if isInRole 'Developer,System Admin,Admin'}}
            <form id="save-linked-projects" class="form-horizontal" role="form">
              <div class="form-group">
                <div class="col-lg-8">
                  <select class="projectsLinked form-control" multiple="multiple">
                    {{#each getProjects}}
                    <option {{isProjectSelected projectId}} value="{{projectId}}">{{projectName}}</option>
                    {{/each}}
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label class="col-md-4 control-label"></label>
                <div class="col-md-8">
                  <input type="submit" class="btn btn-large btn-success" value="Save" />
                </div>
              </div>

            </form>
          {{else}}
            {{#if projectsLinked}}
              <ul>
                {{#each projectsLinked}}
                  <li>{{getProjectName this}}</li>
                {{/each}}
              </ul>
            {{/if}}
          {{/if}}
        </div>
      </div>
    </div>
  </div>

  {{#if debugAPIMode}}
  <div class="box box-default">
    <div class="box-body">
      <h4>HMIS API Data</h4>
      <pre>{{printHMISData}}</pre>
    </div>
  </div>
  {{/if}}
</template>
